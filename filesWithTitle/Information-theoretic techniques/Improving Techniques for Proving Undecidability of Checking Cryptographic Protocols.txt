existing undecidability proofs of checking secrecy of cryptographic protocols have the limitations of not considering protocols common in literature, which are in the form of communication sequences, since only protocols as non-matching roles are considered, and not considering an attacker who is an insider since only an outsider attacker is considered. therefore the complexity of checking the realistic attacks, such as the attack to the public key needham-schroeder protocol, is unknown.the limitations have been observed independently and described similarly by froschle in a recently published paper, where two open problems are posted. this paper investigates these limitations, and we present a generally applicable approach by reductions with novel features from the reachability problem of 2-counter machines, and we solve the two open problems. we also prove the undecidability of checking authentication which is the first detailed proof to our best knowledge. a unique feature of the proof is to directly address the secrecy and authentication goals as defined for the public key needham-schroeder protocol, whose attack has motivated many researches of formal verification of security protocols.improving techniques for proving undecidability of checking cryptographic protocols