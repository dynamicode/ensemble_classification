we design an efficient mode of operation on block ciphers, ss-nmac. our mode has the following properties, when instantiated with a block cipher f to yield a variable-length, keyed hash function h:    (1)  mac preservation.  h is a secure message authentication code (mac) with birthday security, as long as f is unpredictable.    (2)  prf preservation.  h is a secure pseudorandom function (prf) with birthday security, as long as f is pseudorandom.    (3)  security against side-channels. as long as the block cipher f does not leak side-channel information about its internals to the attacker, properties (1) and (2) hold even if the remaining implementation of h is completely leaky. in particular, if the attacker can learn the transcript of all block cipher calls and other auxiliary information needed to implement our mode of operation. our mode is the first to satisfy the mac preservation property (1) with birthday security, solving the main open problem of dodis et al. [7] from eurocrypt 2008. combined with the prf preservation (2), our mode provides a hedge against the case when the block cipher f is more secure as a mac than as a prf: if it is false, as we hope, we get a secure variable-length prf; however, even if true, we still "salvage" a secure mac, which might be enough for a given application.we also remark that no prior mode of operation offered birthday security against side channel attacks, even if the block cipher was assumed pseudorandom.although very efficient, our mode is three times slower than many of the prior modes, such as cbc, which do not enjoy properties (1) and (3). thus, our work motivates further research to understand the gap between unpredictability and pseudorandomness of the existing block ciphers, such as aes.