security protocols are indispensable in secure communication. we give an operational semantics of security protocols in terms of a prolog-like language. with this semantics, we can uncover attacks on a security protocol that are possible with no more than a given number of rounds. though our approach is exhaustive testing, the majority of fruitless search is cut off by selecting a small number of representative values that could be sent by an attacker. hence, the number of scenarios is relatively small and our method is quite practical. furthermore, our method not only reports possible attacks but also describes the attacks in great detail. this description would be very helpful to protocol designers and analyzers.