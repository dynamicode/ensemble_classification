many techniques have been applied to anomaly detection to detect novel attacks, such as statistical analysis, clustering, support vector machines, neural networks and etc. although the results are promising, there's still a serious problem, high false positive rates, which make anomaly detection systems practically unusable. we observe that most network intrusion detection systems (idss) work on information that is only available on lower layers of the network or on higher layers, but not on both. we argue that by correlating the information on different layers, we can have a more efficient anomaly detection system. we introduce an anomaly detection system based on the layer correlation. bayesian networks and statistical analysis are used to build normal system models for the anomaly detection engine. the prototype system is tested on tcpdump traces including normal and anomalous email activities. our experimental results show that our proposed solution is capable of reducing false alarm rates.